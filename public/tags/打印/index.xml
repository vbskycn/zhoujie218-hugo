<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>打印 on 周杰个人博客</title><link>/tags/%E6%89%93%E5%8D%B0/</link><description>Recent content in 打印 on 周杰个人博客</description><generator>Hugo</generator><language>zh-CN</language><lastBuildDate>Wed, 02 Aug 2023 00:00:00 +0000</lastBuildDate><atom:link href="/tags/%E6%89%93%E5%8D%B0/index.xml" rel="self" type="application/rss+xml"/><item><title>老式打印机套娃打印服务器p910nd和cups,实现一些特殊的功能</title><link>/archives/2537.html</link><pubDate>Wed, 02 Aug 2023 00:00:00 +0000</pubDate><guid>/archives/2537.html</guid><description>&lt;h2 id="引子"&gt;引子&lt;/h2&gt;
&lt;p&gt;HP的老旧激光打印机用来在家里给孩子打打作业什么的而是一个不错的选择。然而老旧有老旧的问题：如我的P1108只有USB口，默认情况下只能开PC打印，实在是麻烦。家里正好有常年工作的DS920+，而群晖内置的cups又基本是个废的，只好折腾一下来实现网络共享和无线打印。注意本文基本都是ssh下的终端操作。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Openwrt, 由于路由器的 RAM 一般都比较小，但是直接使用 cups 做打印服务器需要使用较大的资源，因此 Openwrt 系统源里面 现在已经不包含 cups 组件了。因为家里有个wdr3800老路由，安装cups带不动，所以才有了下面的折腾。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;任意一台 24 小时开机的 Linux 设备一台, 用于安装 CUPS 搭建 Airprint Server 使用, 如果不使用 IOS 设备，就不需要 CUPS&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果家中只有 windows 和安卓设备，只需要配置 p910nd&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果家中有可以 24 小时开机并且 ram 大于 1G 并且带有 USB 口的设备，只需要配置 cups&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
 &lt;a data-fancybox="gallery" href="https://img-cloud.zhoujie218.top/2024/06/20/6673add685d3c.png"&gt;
 &lt;img class="mx-auto" alt="" src="https://img-cloud.zhoujie218.top/2024/06/20/6673add685d3c.png" /&gt;
 &lt;/a&gt;
 &lt;/p&gt;
&lt;h2 id="提前说结果最后经过实践"&gt;提前说结果：最后经过实践&lt;/h2&gt;
&lt;p&gt;ubuntu22.04 默认安装的cups 2.41 自带的 惠普老款驱动 3.21.12 就能驱动我的P1108打印机了，简直是折腾了个腾：）&lt;/p&gt;
&lt;p&gt;不过还是建议你参考本文&lt;/p&gt;
&lt;h2 id="准备工作"&gt;准备工作&lt;/h2&gt;
&lt;p&gt;设备：1台P1108，一台DS920+（DSM7.1），一台工作笔记本&lt;/p&gt;
&lt;p&gt;软件：工作笔记本上备好putty、winscp等工具，DS920+开启SSH，下载好最新的hplip和hplip-plugin。&lt;/p&gt;
&lt;p&gt;驱动地址：&lt;a href="https://go.smzdm.com/2f13d177a2f706bc/ca_aa_yc_163_a905p290_17721_1673_173_0"&gt;HP Developers Portal | Version: 3.22.10&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;插件地址：&lt;a href="https://go.smzdm.com/5cc5b1a7dc9ec909/ca_aa_yc_163_a905p290_17721_1673_173_0"&gt;HP Developers Portal | Plugins&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="步骤"&gt;步骤&lt;/h2&gt;
&lt;p&gt;因为相关类似的文章挺多的，我这里不全面展开了，很多内容都有成熟的文章可以参考。主要按照操作步骤梳理下， 帮助大家避坑。&lt;/p&gt;</description></item><item><title>老旧设备利用打印机服务实现网络打印,并实现打印机热插拔</title><link>/archives/2508.html</link><pubDate>Fri, 14 Oct 2022 00:00:00 +0000</pubDate><guid>/archives/2508.html</guid><description>&lt;p&gt;&lt;strong&gt;先决条件：能安装openwrt&lt;/strong&gt; 利用 OpenWrt 在局域网下共享打印机，主要需要以下两个插件&lt;/p&gt;
&lt;h2 id="p910nd打印机服务器"&gt;p910nd打印机服务器&lt;/h2&gt;
&lt;p&gt;sane扫描仪服务及配套的xinetd控制接口 接下来分别介绍两个插件的安装及配置流程&lt;/p&gt;
&lt;p&gt;安装插件 p910nd&lt;/p&gt;
&lt;p&gt;&lt;code&gt;opkg update opkg install kmod-usb-printer p910nd luci-app-p910nd luci-i18n-p910nd-zh-cn&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;连接打印机 将打印机连接到路由器 USB 接口，输入指令&lt;/p&gt;
&lt;p&gt;ssh登入进去 &lt;code&gt;**ls /dev/usb**&lt;/code&gt; 看到lp0设备，就说明 openwrt检测到了打印&lt;/p&gt;
&lt;h2 id="开始使用"&gt;开始使用&lt;/h2&gt;
&lt;p&gt;在 LUCI 界面配置打印机 找到 服务-打印服务器，勾选启动。&lt;/p&gt;
&lt;p&gt;设备填上刚才看到的/dev/usb/lp0(需要选择下来出来的MX390 series FAX)，接口选择未指定即可，端口通常为9100。&lt;/p&gt;
&lt;p&gt;打开putty，登录路由器，输入命令netstat –an，查看当前路由器连接，查询9100的端口是否已经有在监听和使用中，和对应的IP地址是否正确。&lt;/p&gt;
&lt;p&gt;注意如果 OpenWrt 9100端口并没有如下图打开。&lt;/p&gt;
&lt;p&gt;SSH，键入/etc/init.d/p910nd enable，然后重启（必须重启才会生效）。再进入ssh，键入netstat –an，SSH，键入/etc/init.d/p910nd enable，然后重启。再进入ssh，键入netstat –an，&lt;/p&gt;
&lt;p&gt;windows,手机，mac等设备添加打印机就和添加正常网络打印机相同，不再重复&lt;/p&gt;
&lt;h2 id="实现打印机的热插拔"&gt;&lt;a href="https://oldwiki.archive.openwrt.org/doc/howto/p910nd.server"&gt;实现打印机的热插拔&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;在openwrt &amp;ldquo;/etc/hotplug.d/usbmisc/20-p910nd&amp;rdquo; 这个路经下面添加如下代码就可以了&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-basic" data-lang="basic"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;echo &lt;span style="color:#e6db74"&gt;&amp;#34;`date`: HP LaserJet P1108 added&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style="color:#f92672"&gt;/&lt;/span&gt;tmp&lt;span style="color:#f92672"&gt;/&lt;/span&gt;hp&lt;span style="color:#ae81ff"&gt;-1108&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;/&lt;/span&gt;etc&lt;span style="color:#f92672"&gt;/&lt;/span&gt;rc&lt;span style="color:#f92672"&gt;.&lt;/span&gt;d&lt;span style="color:#f92672"&gt;/&lt;/span&gt;S99p910nd restart
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;网件wndr4300路由器，HP p1108 打印机示例&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
 &lt;a data-fancybox="gallery" href="https://img-cloud.zhoujie218.top/wp-content/uploads/2022/10/20221014061423216.png"&gt;
 &lt;img class="mx-auto" alt="" src="https://img-cloud.zhoujie218.top/wp-content/uploads/2022/10/20221014061423216.png" /&gt;
 &lt;/a&gt;
 &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这样即可在打开打印机时自动启动openwrt上面的打印服务&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="每天早上重启一次打印服务"&gt;每天早上重启一次打印服务&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-basic" data-lang="basic"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;30 &lt;span style="color:#ae81ff"&gt;6&lt;/span&gt; &lt;span style="color:#f92672"&gt;*&lt;/span&gt; &lt;span style="color:#f92672"&gt;*&lt;/span&gt; &lt;span style="color:#f92672"&gt;*&lt;/span&gt; &lt;span style="color:#f92672"&gt;/&lt;/span&gt;etc&lt;span style="color:#f92672"&gt;/&lt;/span&gt;rc&lt;span style="color:#f92672"&gt;.&lt;/span&gt;d&lt;span style="color:#f92672"&gt;/&lt;/span&gt;S99p910nd restart
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>